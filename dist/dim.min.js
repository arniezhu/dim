/*! 
 * DIM - Draggable Image Mask
 * @link https://github.com/arniezhu/dim
 * @version 1.0
 * @copyright (c) 2022-present arnie.info All Rights Reserved. 
 */
;function DIM(c,b){b=b||{};this.container=document.getElementById(c);this.code="";this.range={};this.options=b;this.options.direction=b.direction||"right";this.options.padding=parseFloat(b.padding)||0;this.options.angle=parseFloat(b.angle)||0;var e=b.shadow||{};this.options.shadow=e;this.options.shadow.size=e.size||64;this.options.shadow.color=e.color||"#ffcc00";this.options.shadow.opacity=e.opacity||0.5;var a=b.controller||{};this.options.controller=a;this.options.controller.width=a.width||48;this.options.controller.height=a.height||48;this.options.controller.color=a.color||"#ffcc00";var d=(function(){var g=document.documentElement.style,f;if("WebkitAppearance" in g){f="webkit"}else{if("MozAppearance" in g){f="gecko"}else{if(typeof navigator.cpuClass==="string"){f="trident"}else{if(navigator.userAgent.indexOf("Opera")>-1){f="presto"}}}}return{webkit:"Webkit",gecko:"Moz",trident:"ms",presto:"O"}[f]})();this.vendor=d;this.callback=function(){};if(!this.options.width){this.options.width=this.container.clientWidth}this.init()}DIM.prototype.render=function(c,f,e){if(!c){return}f=f||0;e=e||0;var d=document.createElement("div"),a=this.vendor+"Perspective",b=this.vendor+"Transform";if(d.style[a]!==undefined){c.style[b]="translate3d("+f+"px,"+e+"px,0)"}else{c.style[b]="translate("+f+"px,"+e+"px)"}};DIM.prototype.init=function(){this.container.innerHTML="";this.code=Math.random().toString(36).slice(-8);this.is_loaded=false;var e=document.createElement("div");e.className="dim-inner";e.setAttribute("id","dim-inner-"+this.code);e.setAttribute("style","position:relative; overflow: hidden");e.style.boxSizing="border-box";e.style.padding=this.options.padding+"px";e.style.width=this.options.width+"px";this.container.appendChild(e);var g=new Image(),c=document.createElement("div"),b=this.options.width-this.options.padding*2;g.src=this.options.background;c.className="dim-background";c.setAttribute("style","display:block; margin:0; padding: 0");c.style.backgroundImage="url("+this.options.background+")";c.style.backgroundRepeat="no-repeat";c.style.backgroundSize="100% 100%";c.style.width=b+"px";var d=this;var a=function(){e.appendChild(c);d.setRange();d.createMask();d.createController();d.showEffect(0,0);d.registerEvents();typeof d.callback==="function"&&d.callback();d.is_loaded=true};if(this.options.height){var f=this.options.height-this.options.padding*2;c.style.height=f+"px";e.style.height=this.options.height+"px";a()}else{g.onload=function(){var i=b/this.width,h=this.height*i+d.options.padding*2;d.options.height=h;e.style.height=h+"px";c.style.height=this.height*i+"px";a()}}};DIM.prototype.setRange=function(){var h=this.options.direction,d=Math.abs(this.options.angle)%360,a=this.options.width-this.options.padding*2,j=this.options.height-this.options.padding*2;if(d>180){d=360-d}var e=h!=="up"&&h!=="down"?true:false,f=h!=="left"&&h!=="up"?0:100;if(e){var g=this.options.width,c=Math.abs(d-90)*Math.PI/180,b=d*Math.PI/180}else{if(d<=90){var g=this.options.height,c=b=d*Math.PI/180}else{var g=this.options.height,c=(180-d)*Math.PI/180,b=d*Math.PI/180}}var k=Math.sin(c)*a+Math.cos(c)*j,i=k/Math.cos(b);this.range={is_horizontal:e,position:f/100*g,last_position:0,gradient_length:k,track_length:i,min:0,max:g}};DIM.prototype.createMask=function(){var d=document.getElementById("dim-inner-"+this.code);var a=document.createElement("div"),b=this.options.width-this.options.padding*2,c=this.options.height-this.options.padding*2;a.className="dim-mask";a.setAttribute("id","dim-mask-"+this.code);a.style.position="absolute";a.style.left=this.options.padding+"px";a.style.top=this.options.padding+"px";a.style.width=b+"px";a.style.height=c+"px";a.style.backgroundImage="url("+this.options.mask+")";a.style.backgroundRepeat="no-repeat";a.style.backgroundSize="100% 100%";d.appendChild(a)};DIM.prototype.createController=function(){var i=document.getElementById("dim-inner-"+this.code),e=this.range.is_horizontal;var d=document.createElement("div");d.className="dim-controller-box";d.setAttribute("id","dim-controller-box-"+this.code);var b=e?"0":"50%",h=e?"50%":"0";d.setAttribute("style","position: absolute; left:"+b+"; top:"+h);i.appendChild(d);this.generateShadow();var f=document.createElement("div");f.className="dim-controller";f.setAttribute("id","dim-controller-"+this.code);f.style.position="absolute";f.style.width=this.options.controller.width;f.style.height=this.options.controller.height;f.style.cursor="move";d.appendChild(f);if(!this.options.controller.icon){var c=e?0:90,a="translate(-50%,-50%) rotate("+c+"deg)";f.style[this.vendor+"Transform"]=a;this.generateIcon()}else{var g=document.createElement("img");g.src=this.options.controller.icon;g.width=this.options.controller.width;g.height=this.options.controller.height;var c=0-this.options.angle,a="translate(-50%,-50%) rotate("+c+"deg)";f.style[this.vendor+"Transform"]=a;f.appendChild(g)}};DIM.prototype.generateShadow=function(){var c=document.getElementById("dim-controller-box-"+this.code);shadow=document.createElement("div"),color=this.options.shadow.color,transparent="rgba(255,255,255,0)",direction=this.options.direction;shadow.className="dim-shadow";shadow.setAttribute("style","position: absolute; left: 50%; top: 50%");shadow.style.opacity=this.options.shadow.opacity;if(direction==="right"||direction==="left"){shadow.style.width=this.options.shadow.size+"px";shadow.style.height=this.options.height*10+"px";shadow.style.marginTop=-this.options.height*5+"px";if(direction==="right"){var a="right center",b="linear-gradient(90deg,transparent,"+color+")";shadow.style.marginLeft=-this.options.shadow.size+"px"}else{var a="left center",b="linear-gradient(90deg,"+color+",transparent)"}}else{shadow.style.width=this.options.width*10+"px";shadow.style.height=this.options.shadow.size+"px";shadow.style.marginLeft=-this.options.width*5+"px";if(direction!=="up"){var a="center bottom",b="linear-gradient(0deg,"+color+",transparent)";shadow.style.marginTop=-this.options.shadow.size+"px"}else{var a="center top",b="linear-gradient(0deg,transparent,"+color+")"}}shadow.style[this.vendor+"Transform"]="rotate("+this.options.angle+"deg)";shadow.style[this.vendor+"TransformOrigin"]=a;shadow.style.backgroundImage=b;c.appendChild(shadow)};DIM.prototype.generateIcon=function(){var d=document.getElementById("dim-controller-"+this.code),a=document.createElementNS("http://www.w3.org/2000/svg","svg");var b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.setAttribute("cx",16);b.setAttribute("cy",16);b.setAttribute("r",16);b.setAttribute("fill",this.options.controller.color);var c=document.createElementNS("http://www.w3.org/2000/svg","polygon"),f="14,12 13,11 8,16 13,21 14,20 10,16";c.setAttribute("points",f);c.setAttribute("fill","#333");var g=document.createElementNS("http://www.w3.org/2000/svg","polygon"),e="18,12 19,11 24,16 19,21 18,20 22,16";g.setAttribute("points",e);g.setAttribute("fill","#333");a.appendChild(b);a.appendChild(c);a.appendChild(g);a.setAttribute("width",this.options.controller.width);a.setAttribute("height",this.options.controller.height);a.setAttribute("viewBox","0 0 32 32");d.appendChild(a)};DIM.prototype.registerEvents=function(){if(/AppleWebKit.*Mobile.*/.test(navigator.userAgent)){this.listenTouchEvents()}else{this.listenMouseEvents()}};DIM.prototype.listenTouchEvents=function(){var b=document.getElementById("dim-controller-"+this.code),c=this,a,d;b.addEventListener("touchstart",function(f){a=f.touches[0].clientX;d=f.touches[0].clientY});b.addEventListener("touchmove",function(h){h.preventDefault();var g=h.changedTouches[0].clientX-a,f=h.changedTouches[0].clientY-d;c.showEffect(g,f)});b.addEventListener("touchend",function(){c.range.position=c.range.last_position})};DIM.prototype.listenMouseEvents=function(){var a=document.getElementById("dim-controller-"+this.code),b=this;a.onmousedown=function(f){f.preventDefault();f.stopPropagation();var d=function(h){h.preventDefault();h.stopPropagation()};if(/WebKit/i.test(navigator.userAgent)){document.addEventListener("mousedown",d,false)}var c=f.clientX,g=f.clientY;document.onmousemove=function(h){b.showEffect(h.clientX-c,h.clientY-g);return false};document.onmouseup=function(){document.onmousemove=null;b.range.position=b.range.last_position;if(/WebKit/i.test(navigator.userAgent)){document.removeEventListener("mousedown",d,false)}}}};DIM.prototype.showEffect=function(k,g){var p=document.getElementById("dim-mask-"+this.code),f=document.getElementById("dim-controller-box-"+this.code),i=this.options.direction;var n=this.range.gradient_length,m=this.range.track_length,j=this.options.padding,o=this.range.is_horizontal?this.options.width-j*2:this.options.height-j*2;var d=this.range.is_horizontal?this.range.position+k:this.range.position+g;if(d<this.range.min){d=this.range.min}if(d>this.range.max){d=this.range.max}if(this.range.is_horizontal){this.render(f,d,0);var b=this.options.angle-90}else{this.render(f,0,d);var b=this.options.angle}var a=(m-o),l=Math.cos(this.options.angle*Math.PI/180),c=n-(d-j+a/2)*l,h=i!=="left"&&i!=="up"?"transparent,transparent "+c+"px,black "+c+"px,black":"black,black "+c+"px,transparent "+c+"px,transparent",e="linear-gradient("+b+"deg,"+h+")";if(p){p.style[this.vendor+"MaskImage"]=e}this.range.last_position=d};DIM.prototype.preview=function(l,k){var f=typeof arguments[0]==="object"?arguments[0]:{},h=Math.abs(parseInt(arguments[1]))||1000;if(!arguments[1]&&typeof arguments[0]==="number"){h=Math.abs(parseInt(arguments[0]))}var c=parseFloat(f.start)||0,i=parseFloat(f.end)||100,d=i-c,g=f.u_turn?true:false,j=this;if(c<0){c=0}if(c>100){c=100}if(i<0){i=0}if(i>100){i=100}if(i<c&&!g){d=c-i}else{if(i<=c&&g){d=(100-c)*2+(c-i)}else{if(i>=c&&g){d=(100-i)*2+(i-c)}}}var e=function(){var m=j.range.max,q=j.options.direction,p=d/100*m/h*5,o=false,n=0,a=(q==="right"||q==="down")?(i-c)/100*m:(c-i)/100*m;j.range.position=(q==="right"||q==="down")?c/100*m:(100-c)/100*m;var b=function(){n=a;j.showEffect(n,n);j.range.position=j.range.last_position;clearInterval(r)};var r=setInterval(function(){j.showEffect(n,n);if(q==="right"||q==="down"){n+=(!o&&!(c>i&&!g))?p:-p;var s=m-c/100*m;if(!g&&c<=i&&n>=a||!g&&c>i&&n<=a||g&&o&&n<=a){b()}else{if(g&&!o&&n>=s){n=s;o=true}}}else{n+=(!o&&!(c>i&&!g))?-p:p;var s=0-(100-c)/100*m;if(!g&&c<=i&&n<=a||!g&&c>i&&n>=a||g&&o&&n>=a){b()}else{if(g&&!o&&n<=s){n=s;o=true}}}},5)};this.is_loaded?e():this.callback=e};